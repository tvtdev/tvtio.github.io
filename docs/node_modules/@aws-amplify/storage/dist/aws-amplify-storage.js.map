{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./lib-esm/Providers/AWSS3Provider.js","webpack:///./lib-esm/Providers/index.js","webpack:///./lib-esm/Storage.js","webpack:///./lib-esm/index.js","webpack:///external \"@aws-amplify/core\"","webpack:///external \"aws-sdk/clients/s3\""],"names":["__assign","Object","i","n","arguments","s","t","__awaiter","value","resolve","P","step","generator","reject","result","adopt","_arguments","__generator","_","label","sent","trys","ops","next","verb","g","Symbol","f","y","op","done","body","logger","AMPLIFY_SYMBOL","dispatchStorageEvent","Hub","event","data","attrs","metrics","message","localTestingStorageEndpoint","AWSS3Provider","config","amplifyConfig","Parser","_a","credentialsOK","Promise","opt","bucket","download","track","expires","prefix","final_key","s3","params","Bucket","Key","method","err","rej","fileSize","Number","res","url","progressCallback","contentType","contentDisposition","cacheControl","metadata","tagging","serverSideEncryption","SSECustomerAlgorithm","SSECustomerKey","SSECustomerKeyMD5","SSEKMSKeyId","type","Body","ContentType","upload","key","e_1","final_path","Prefix","list","item","eTag","lastModified","size","Size","_this","cred","Credentials","credentials","level","customPrefix","identityId","privatePath","protectedPath","publicPath","region","dangerouslyConnectToHttpEndpointForTesting","localTestingConfig","endpoint","s3BucketEndpoint","s3ForcePathStyle","apiVersion","signatureVersion","DEFAULT_PROVIDER","StorageClass","pluggable","storageKeysFromConfig","storageArrayKeys","isInStorageArrayKeys","x","checkConfigKeysFromArray","provider","prov","_instance","old_configure_1","vaultConfig","Storage","Amplify"],"mappings":"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","file":"aws-amplify-storage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@aws-amplify/core\"), require(\"aws-sdk/clients/s3\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"aws_amplify_storage\", [\"@aws-amplify/core\", \"aws-sdk/clients/s3\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"aws_amplify_storage\"] = factory(require(\"@aws-amplify/core\"), require(\"aws-sdk/clients/s3\"));\n\telse\n\t\troot[\"aws_amplify_storage\"] = factory(root[\"@aws-amplify/core\"], root[\"aws-sdk/clients/s3\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__aws_amplify_core__, __WEBPACK_EXTERNAL_MODULE_aws_sdk_clients_s3__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib-esm/index.js\");\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nimport { ConsoleLogger as Logger, Hub, Credentials, Parser, } from '@aws-amplify/core';\nimport * as S3 from 'aws-sdk/clients/s3';\nvar logger = new Logger('AWSS3Provider');\nvar AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined' &&\n    typeof Symbol.for === 'function'\n    ? Symbol.for('amplify_default')\n    : '@@amplify_default');\nvar dispatchStorageEvent = function (track, event, attrs, metrics, message) {\n    if (track) {\n        Hub.dispatch('storage', {\n            event: event,\n            data: { attrs: attrs, metrics: metrics },\n            message: message,\n        }, 'Storage', AMPLIFY_SYMBOL);\n    }\n};\nvar localTestingStorageEndpoint = 'http://localhost:20005';\n/**\n * Provide storage methods to use AWS S3\n */\nvar AWSS3Provider = /** @class */ (function () {\n    /**\n     * Initialize Storage with AWS configurations\n     * @param {Object} config - Configuration object for storage\n     */\n    function AWSS3Provider(config) {\n        this._config = config ? config : {};\n        logger.debug('Storage Options', this._config);\n    }\n    /**\n     * get the category of the plugin\n     */\n    AWSS3Provider.prototype.getCategory = function () {\n        return AWSS3Provider.CATEGORY;\n    };\n    /**\n     * get provider name of the plugin\n     */\n    AWSS3Provider.prototype.getProviderName = function () {\n        return AWSS3Provider.PROVIDER_NAME;\n    };\n    /**\n     * Configure Storage part with aws configuration\n     * @param {Object} config - Configuration of the Storage\n     * @return {Object} - Current configuration\n     */\n    AWSS3Provider.prototype.configure = function (config) {\n        logger.debug('configure Storage', config);\n        if (!config)\n            return this._config;\n        var amplifyConfig = Parser.parseMobilehubConfig(config);\n        this._config = Object.assign({}, this._config, amplifyConfig.Storage);\n        if (!this._config.bucket) {\n            logger.debug('Do not have bucket yet');\n        }\n        return this._config;\n    };\n    /**\n     * Get a presigned URL of the file or the object data when download:true\n     *\n     * @param {String} key - key of the object\n     * @param {Object} [config] - { level : private|protected|public, download: true|false }\n     * @return - A promise resolves to Amazon S3 presigned URL on success\n     */\n    AWSS3Provider.prototype.get = function (key, config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var credentialsOK, opt, bucket, download, track, expires, prefix, final_key, s3, params;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._ensureCredentials()];\n                    case 1:\n                        credentialsOK = _a.sent();\n                        if (!credentialsOK) {\n                            return [2 /*return*/, Promise.reject('No credentials')];\n                        }\n                        opt = Object.assign({}, this._config, config);\n                        bucket = opt.bucket, download = opt.download, track = opt.track, expires = opt.expires;\n                        prefix = this._prefix(opt);\n                        final_key = prefix + key;\n                        s3 = this._createS3(opt);\n                        logger.debug('get ' + key + ' from ' + final_key);\n                        params = {\n                            Bucket: bucket,\n                            Key: final_key,\n                        };\n                        if (download === true) {\n                            return [2 /*return*/, new Promise(function (res, rej) {\n                                    s3.getObject(params, function (err, data) {\n                                        if (err) {\n                                            dispatchStorageEvent(track, 'download', {\n                                                method: 'get',\n                                                result: 'failed',\n                                            }, null, \"Download failed with \" + err.message);\n                                            rej(err);\n                                        }\n                                        else {\n                                            dispatchStorageEvent(track, 'download', { method: 'get', result: 'success' }, { fileSize: Number(data.Body['length']) }, \"Download success for \" + key);\n                                            res(data);\n                                        }\n                                    });\n                                })];\n                        }\n                        if (expires) {\n                            params.Expires = expires;\n                        }\n                        return [2 /*return*/, new Promise(function (res, rej) {\n                                try {\n                                    var url = s3.getSignedUrl('getObject', params);\n                                    dispatchStorageEvent(track, 'getSignedUrl', { method: 'get', result: 'success' }, null, \"Signed URL: \" + url);\n                                    res(url);\n                                }\n                                catch (e) {\n                                    logger.warn('get signed url error', e);\n                                    dispatchStorageEvent(track, 'getSignedUrl', { method: 'get', result: 'failed' }, null, \"Could not get a signed URL for \" + key);\n                                    rej(e);\n                                }\n                            })];\n                }\n            });\n        });\n    };\n    /**\n     * Put a file in S3 bucket specified to configure method\n     * @param {String} key - key of the object\n     * @param {Object} object - File to be put in Amazon S3 bucket\n     * @param {Object} [config] - { level : private|protected|public, contentType: MIME Types,\n     *  progressCallback: function }\n     * @return - promise resolves to object on success\n     */\n    AWSS3Provider.prototype.put = function (key, object, config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var credentialsOK, opt, bucket, track, progressCallback, contentType, contentDisposition, cacheControl, expires, metadata, tagging, serverSideEncryption, SSECustomerAlgorithm, SSECustomerKey, SSECustomerKeyMD5, SSEKMSKeyId, type, prefix, final_key, s3, params, upload, data, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._ensureCredentials()];\n                    case 1:\n                        credentialsOK = _a.sent();\n                        if (!credentialsOK) {\n                            return [2 /*return*/, Promise.reject('No credentials')];\n                        }\n                        opt = Object.assign({}, this._config, config);\n                        bucket = opt.bucket, track = opt.track, progressCallback = opt.progressCallback;\n                        contentType = opt.contentType, contentDisposition = opt.contentDisposition, cacheControl = opt.cacheControl, expires = opt.expires, metadata = opt.metadata, tagging = opt.tagging;\n                        serverSideEncryption = opt.serverSideEncryption, SSECustomerAlgorithm = opt.SSECustomerAlgorithm, SSECustomerKey = opt.SSECustomerKey, SSECustomerKeyMD5 = opt.SSECustomerKeyMD5, SSEKMSKeyId = opt.SSEKMSKeyId;\n                        type = contentType ? contentType : 'binary/octet-stream';\n                        prefix = this._prefix(opt);\n                        final_key = prefix + key;\n                        s3 = this._createS3(opt);\n                        logger.debug('put ' + key + ' to ' + final_key);\n                        params = {\n                            Bucket: bucket,\n                            Key: final_key,\n                            Body: object,\n                            ContentType: type,\n                        };\n                        if (cacheControl) {\n                            params.CacheControl = cacheControl;\n                        }\n                        if (contentDisposition) {\n                            params.ContentDisposition = contentDisposition;\n                        }\n                        if (expires) {\n                            params.Expires = expires;\n                        }\n                        if (metadata) {\n                            params.Metadata = metadata;\n                        }\n                        if (tagging) {\n                            params.Tagging = tagging;\n                        }\n                        if (serverSideEncryption) {\n                            params.ServerSideEncryption = serverSideEncryption;\n                            if (SSECustomerAlgorithm) {\n                                params.SSECustomerAlgorithm = SSECustomerAlgorithm;\n                            }\n                            if (SSECustomerKey) {\n                                params.SSECustomerKey = SSECustomerKey;\n                            }\n                            if (SSECustomerKeyMD5) {\n                                params.SSECustomerKeyMD5 = SSECustomerKeyMD5;\n                            }\n                            if (SSEKMSKeyId) {\n                                params.SSEKMSKeyId = SSEKMSKeyId;\n                            }\n                        }\n                        _a.label = 2;\n                    case 2:\n                        _a.trys.push([2, 4, , 5]);\n                        upload = s3.upload(params).on('httpUploadProgress', function (progress) {\n                            if (progressCallback) {\n                                if (typeof progressCallback === 'function') {\n                                    progressCallback(progress);\n                                }\n                                else {\n                                    logger.warn('progressCallback should be a function, not a ' +\n                                        typeof progressCallback);\n                                }\n                            }\n                        });\n                        return [4 /*yield*/, upload.promise()];\n                    case 3:\n                        data = _a.sent();\n                        logger.debug('upload result', data);\n                        dispatchStorageEvent(track, 'upload', { method: 'put', result: 'success' }, null, \"Upload success for \" + key);\n                        return [2 /*return*/, {\n                                key: data.Key.substr(prefix.length),\n                            }];\n                    case 4:\n                        e_1 = _a.sent();\n                        logger.warn('error uploading', e_1);\n                        dispatchStorageEvent(track, 'upload', { method: 'put', result: 'failed' }, null, \"Error uploading \" + key);\n                        throw e_1;\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Remove the object for specified key\n     * @param {String} key - key of the object\n     * @param {Object} [config] - { level : private|protected|public }\n     * @return - Promise resolves upon successful removal of the object\n     */\n    AWSS3Provider.prototype.remove = function (key, config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var credentialsOK, opt, bucket, track, prefix, final_key, s3, params;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._ensureCredentials()];\n                    case 1:\n                        credentialsOK = _a.sent();\n                        if (!credentialsOK) {\n                            return [2 /*return*/, Promise.reject('No credentials')];\n                        }\n                        opt = Object.assign({}, this._config, config);\n                        bucket = opt.bucket, track = opt.track;\n                        prefix = this._prefix(opt);\n                        final_key = prefix + key;\n                        s3 = this._createS3(opt);\n                        logger.debug('remove ' + key + ' from ' + final_key);\n                        params = {\n                            Bucket: bucket,\n                            Key: final_key,\n                        };\n                        return [2 /*return*/, new Promise(function (res, rej) {\n                                s3.deleteObject(params, function (err, data) {\n                                    if (err) {\n                                        dispatchStorageEvent(track, 'delete', { method: 'remove', result: 'failed' }, null, \"Deletion of \" + key + \" failed with \" + err);\n                                        rej(err);\n                                    }\n                                    else {\n                                        dispatchStorageEvent(track, 'delete', { method: 'remove', result: 'success' }, null, \"Deleted \" + key + \" successfully\");\n                                        res(data);\n                                    }\n                                });\n                            })];\n                }\n            });\n        });\n    };\n    /**\n     * List bucket objects relative to the level and prefix specified\n     * @param {String} path - the path that contains objects\n     * @param {Object} [config] - { level : private|protected|public }\n     * @return - Promise resolves to list of keys for all objects in path\n     */\n    AWSS3Provider.prototype.list = function (path, config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var credentialsOK, opt, bucket, track, prefix, final_path, s3, params;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._ensureCredentials()];\n                    case 1:\n                        credentialsOK = _a.sent();\n                        if (!credentialsOK) {\n                            return [2 /*return*/, Promise.reject('No credentials')];\n                        }\n                        opt = Object.assign({}, this._config, config);\n                        bucket = opt.bucket, track = opt.track;\n                        prefix = this._prefix(opt);\n                        final_path = prefix + path;\n                        s3 = this._createS3(opt);\n                        logger.debug('list ' + path + ' from ' + final_path);\n                        params = {\n                            Bucket: bucket,\n                            Prefix: final_path,\n                        };\n                        return [2 /*return*/, new Promise(function (res, rej) {\n                                s3.listObjects(params, function (err, data) {\n                                    if (err) {\n                                        logger.warn('list error', err);\n                                        dispatchStorageEvent(track, 'list', { method: 'list', result: 'failed' }, null, \"Listing items failed: \" + err.message);\n                                        rej(err);\n                                    }\n                                    else {\n                                        var list = data.Contents.map(function (item) {\n                                            return {\n                                                key: item.Key.substr(prefix.length),\n                                                eTag: item.ETag,\n                                                lastModified: item.LastModified,\n                                                size: item.Size,\n                                            };\n                                        });\n                                        dispatchStorageEvent(track, 'list', { method: 'list', result: 'success' }, null, list.length + \" items returned from list operation\");\n                                        logger.debug('list', list);\n                                        res(list);\n                                    }\n                                });\n                            })];\n                }\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    AWSS3Provider.prototype._ensureCredentials = function () {\n        var _this = this;\n        return Credentials.get()\n            .then(function (credentials) {\n            if (!credentials)\n                return false;\n            var cred = Credentials.shear(credentials);\n            logger.debug('set credentials for storage', cred);\n            _this._config.credentials = cred;\n            return true;\n        })\n            .catch(function (err) {\n            logger.warn('ensure credentials error', err);\n            return false;\n        });\n    };\n    /**\n     * @private\n     */\n    AWSS3Provider.prototype._prefix = function (config) {\n        var credentials = config.credentials, level = config.level;\n        var customPrefix = config.customPrefix || {};\n        var identityId = config.identityId || credentials.identityId;\n        var privatePath = (customPrefix.private !== undefined ? customPrefix.private : 'private/') +\n            identityId +\n            '/';\n        var protectedPath = (customPrefix.protected !== undefined\n            ? customPrefix.protected\n            : 'protected/') +\n            identityId +\n            '/';\n        var publicPath = customPrefix.public !== undefined ? customPrefix.public : 'public/';\n        switch (level) {\n            case 'private':\n                return privatePath;\n            case 'protected':\n                return protectedPath;\n            default:\n                return publicPath;\n        }\n    };\n    /**\n     * @private\n     */\n    AWSS3Provider.prototype._createS3 = function (config) {\n        var bucket = config.bucket, region = config.region, credentials = config.credentials, dangerouslyConnectToHttpEndpointForTesting = config.dangerouslyConnectToHttpEndpointForTesting;\n        var localTestingConfig = {};\n        if (dangerouslyConnectToHttpEndpointForTesting) {\n            localTestingConfig = {\n                endpoint: localTestingStorageEndpoint,\n                s3BucketEndpoint: true,\n                s3ForcePathStyle: true,\n            };\n        }\n        return new S3(__assign({ apiVersion: '2006-03-01', params: { Bucket: bucket }, signatureVersion: 'v4', region: region,\n            credentials: credentials }, localTestingConfig));\n    };\n    AWSS3Provider.CATEGORY = 'Storage';\n    AWSS3Provider.PROVIDER_NAME = 'AWSS3';\n    return AWSS3Provider;\n}());\nexport default AWSS3Provider;\n//# sourceMappingURL=AWSS3Provider.js.map","import AWSS3Provider from './AWSS3Provider';\nexport { AWSS3Provider };\n//# sourceMappingURL=index.js.map","/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { ConsoleLogger as Logger, Parser } from '@aws-amplify/core';\nimport AWSS3Provider from './Providers/AWSS3Provider';\nvar logger = new Logger('StorageClass');\nvar DEFAULT_PROVIDER = 'AWSS3';\n/**\n * Provide storage methods to use AWS S3\n */\nvar StorageClass = /** @class */ (function () {\n    /**\n     * Initialize Storage\n     * @param {Object} config - Configuration object for storage\n     */\n    function StorageClass() {\n        this._config = {};\n        this._pluggables = [];\n        logger.debug('Storage Options', this._config);\n        this.get = this.get.bind(this);\n        this.put = this.put.bind(this);\n        this.remove = this.remove.bind(this);\n        this.list = this.list.bind(this);\n    }\n    StorageClass.prototype.getModuleName = function () {\n        return 'Storage';\n    };\n    /**\n     * add plugin into Storage category\n     * @param {Object} pluggable - an instance of the plugin\n     */\n    StorageClass.prototype.addPluggable = function (pluggable) {\n        if (pluggable && pluggable.getCategory() === 'Storage') {\n            this._pluggables.push(pluggable);\n            var config = {};\n            config = pluggable.configure(this._config[pluggable.getProviderName()]);\n            return config;\n        }\n    };\n    /**\n     * Get the plugin object\n     * @param providerName - the name of the plugin\n     */\n    StorageClass.prototype.getPluggable = function (providerName) {\n        var pluggable = this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === providerName; });\n        if (pluggable === undefined) {\n            logger.debug('No plugin found with providerName', providerName);\n            return null;\n        }\n        else\n            return pluggable;\n    };\n    /**\n     * Remove the plugin object\n     * @param providerName - the name of the plugin\n     */\n    StorageClass.prototype.removePluggable = function (providerName) {\n        this._pluggables = this._pluggables.filter(function (pluggable) { return pluggable.getProviderName() !== providerName; });\n        return;\n    };\n    /**\n     * Configure Storage\n     * @param {Object} config - Configuration object for storage\n     * @return {Object} - Current configuration\n     */\n    StorageClass.prototype.configure = function (config) {\n        var _this = this;\n        logger.debug('configure Storage');\n        if (!config)\n            return this._config;\n        var amplifyConfig = Parser.parseMobilehubConfig(config);\n        var storageKeysFromConfig = Object.keys(amplifyConfig.Storage);\n        var storageArrayKeys = [\n            'bucket',\n            'region',\n            'level',\n            'track',\n            'customPrefix',\n            'serverSideEncryption',\n            'SSECustomerAlgorithm',\n            'SSECustomerKey',\n            'SSECustomerKeyMD5',\n            'SSEKMSKeyId',\n        ];\n        var isInStorageArrayKeys = function (k) {\n            return storageArrayKeys.some(function (x) { return x === k; });\n        };\n        var checkConfigKeysFromArray = function (k) {\n            return k.find(function (k) { return isInStorageArrayKeys(k); });\n        };\n        if (storageKeysFromConfig &&\n            checkConfigKeysFromArray(storageKeysFromConfig) &&\n            !amplifyConfig.Storage[DEFAULT_PROVIDER]) {\n            amplifyConfig.Storage[DEFAULT_PROVIDER] = {};\n        }\n        Object.entries(amplifyConfig.Storage).map(function (_a) {\n            var key = _a[0], value = _a[1];\n            if (key && isInStorageArrayKeys(key) && value !== undefined) {\n                amplifyConfig.Storage[DEFAULT_PROVIDER][key] = value;\n                delete amplifyConfig.Storage[key];\n            }\n        });\n        // only update new values for each provider\n        Object.keys(amplifyConfig.Storage).forEach(function (providerName) {\n            if (typeof amplifyConfig.Storage[providerName] !== 'string') {\n                _this._config[providerName] = __assign(__assign({}, _this._config[providerName]), amplifyConfig.Storage[providerName]);\n            }\n        });\n        this._pluggables.forEach(function (pluggable) {\n            pluggable.configure(_this._config[pluggable.getProviderName()]);\n        });\n        if (this._pluggables.length === 0) {\n            this.addPluggable(new AWSS3Provider());\n        }\n        return this._config;\n    };\n    /**\n     * Get a presigned URL of the file or the object data when download:true\n     *\n     * @param {String} key - key of the object\n     * @param {Object} [config] - { level : private|protected|public, download: true|false }\n     * @return - A promise resolves to either a presigned url or the object\n     */\n    StorageClass.prototype.get = function (key, config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, provider, prov;\n            return __generator(this, function (_b) {\n                _a = (config || {}).provider, provider = _a === void 0 ? DEFAULT_PROVIDER : _a;\n                prov = this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === provider; });\n                if (prov === undefined) {\n                    logger.debug('No plugin found with providerName', provider);\n                    Promise.reject('No plugin found in Storage for the provider');\n                }\n                return [2 /*return*/, prov.get(key, config)];\n            });\n        });\n    };\n    /**\n     * Put a file in storage bucket specified to configure method\n     * @param {String} key - key of the object\n     * @param {Object} object - File to be put in bucket\n     * @param {Object} [config] - { level : private|protected|public, contentType: MIME Types,\n     *  progressCallback: function }\n     * @return - promise resolves to object on success\n     */\n    StorageClass.prototype.put = function (key, object, config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, provider, prov;\n            return __generator(this, function (_b) {\n                _a = (config || {}).provider, provider = _a === void 0 ? DEFAULT_PROVIDER : _a;\n                prov = this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === provider; });\n                if (prov === undefined) {\n                    logger.debug('No plugin found with providerName', provider);\n                    Promise.reject('No plugin found in Storage for the provider');\n                }\n                return [2 /*return*/, prov.put(key, object, config)];\n            });\n        });\n    };\n    /**\n     * Remove the object for specified key\n     * @param {String} key - key of the object\n     * @param {Object} [config] - { level : private|protected|public }\n     * @return - Promise resolves upon successful removal of the object\n     */\n    StorageClass.prototype.remove = function (key, config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, provider, prov;\n            return __generator(this, function (_b) {\n                _a = (config || {}).provider, provider = _a === void 0 ? DEFAULT_PROVIDER : _a;\n                prov = this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === provider; });\n                if (prov === undefined) {\n                    logger.debug('No plugin found with providerName', provider);\n                    Promise.reject('No plugin found in Storage for the provider');\n                }\n                return [2 /*return*/, prov.remove(key, config)];\n            });\n        });\n    };\n    /**\n     * List bucket objects relative to the level and prefix specified\n     * @param {String} path - the path that contains objects\n     * @param {Object} [config] - { level : private|protected|public }\n     * @return - Promise resolves to list of keys for all objects in path\n     */\n    StorageClass.prototype.list = function (path, config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, provider, prov;\n            return __generator(this, function (_b) {\n                _a = (config || {}).provider, provider = _a === void 0 ? DEFAULT_PROVIDER : _a;\n                prov = this._pluggables.find(function (pluggable) { return pluggable.getProviderName() === provider; });\n                if (prov === undefined) {\n                    logger.debug('No plugin found with providerName', provider);\n                    Promise.reject('No plugin found in Storage for the provider');\n                }\n                return [2 /*return*/, prov.list(path, config)];\n            });\n        });\n    };\n    return StorageClass;\n}());\nexport default StorageClass;\n//# sourceMappingURL=Storage.js.map","/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport StorageClass from './Storage';\nimport Amplify, { ConsoleLogger as Logger } from '@aws-amplify/core';\nvar logger = new Logger('Storage');\nvar _instance = null;\nif (!_instance) {\n    logger.debug('Create Storage Instance');\n    _instance = new StorageClass();\n    _instance.vault = new StorageClass();\n    var old_configure_1 = _instance.configure;\n    _instance.configure = function (options) {\n        logger.debug('storage configure called');\n        var vaultConfig = __assign({}, old_configure_1.call(_instance, options));\n        // set level private for each provider for the vault\n        Object.keys(vaultConfig).forEach(function (providerName) {\n            if (typeof vaultConfig[providerName] !== 'string') {\n                vaultConfig[providerName] = __assign(__assign({}, vaultConfig[providerName]), { level: 'private' });\n            }\n        });\n        logger.debug('storage vault configure called');\n        _instance.vault.configure(vaultConfig);\n    };\n}\nvar Storage = _instance;\nAmplify.register(Storage);\nexport default Storage;\nexport { StorageClass };\nexport * from './Providers';\n//# sourceMappingURL=index.js.map","module.exports = __WEBPACK_EXTERNAL_MODULE__aws_amplify_core__;","module.exports = __WEBPACK_EXTERNAL_MODULE_aws_sdk_clients_s3__;"],"sourceRoot":""}